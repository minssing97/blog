<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI ë‰´ìŠ¤ & ë¸”ë¡œê·¸ ì—ë””í„°</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & Babel CDN -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Lucide Icons CDN -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap');
        body { font-family: 'Noto Sans KR', sans-serif; }
        .animate-spin-slow { animation: spin 3s linear infinite; }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        /* Markdown Style for Preview */
        .prose table { width: 100%; border-collapse: collapse; margin: 1rem 0; }
        .prose th, .prose td { border: 1px solid #e2e8f0; padding: 0.75rem; text-align: left; }
        .prose th { background-color: #f8fafc; font-weight: bold; }
        .prose h1, .prose h2, .prose h3 { margin-top: 1.5rem; margin-bottom: 0.5rem; font-weight: 800; }
        .prose p { margin-bottom: 1rem; line-height: 1.8; }
    </style>
</head>
<body class="bg-slate-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useRef, useEffect } = React;

        // --- Icon Component (Helper to render Lucide icons in React) ---
        const Icon = ({ name, className, ...props }) => {
            const iconRef = useRef(null);
            useEffect(() => {
                if (window.lucide && iconRef.current) {
                    window.lucide.createIcons({
                        attrs: { class: className },
                        nameAttr: 'data-lucide',
                        icons: { [name]: window.lucide.icons[name] }
                    });
                }
            }, [name, className]);
            return <i data-lucide={name} ref={iconRef} {...props}></i>;
        };

        const App = () => {
            const [topic, setTopic] = useState('');
            const [selectedSource, setSelectedSource] = useState('google');
            const [results, setResults] = useState([]);
            const [loading, setLoading] = useState(false);
            const [error, setError] = useState(null);
            
            const [apiKey, setApiKey] = useState("");
            const [showKey, setShowKey] = useState(false);
            const [isModalOpen, setIsModalOpen] = useState(false);

            const [selectedIndices, setSelectedIndices] = useState(new Set());
            const [blogPost, setBlogPost] = useState('');
            const [isBlogGenerating, setIsBlogGenerating] = useState(false);

            const resultsRef = useRef(null);
            const blogRef = useRef(null);

            const sources = {
                google: {
                    name: 'êµ¬ê¸€ ë‰´ìŠ¤',
                    color: 'bg-orange-500',
                    textColor: 'text-orange-600',
                    getURL: (query) => `https://news.google.com/rss/search?q=${encodeURIComponent(query)}&hl=ko&gl=KR&ceid=KR:ko`
                },
                bbc: {
                    name: 'BBC World',
                    color: 'bg-red-700',
                    textColor: 'text-red-700',
                    getURL: () => `https://feeds.bbci.co.uk/news/world/rss.xml`
                },
                yonhap: {
                    name: 'ì—°í•©ë‰´ìŠ¤ TV',
                    color: 'bg-blue-600',
                    textColor: 'text-blue-600',
                    getURL: () => `https://www.yonhapnewstv.co.kr/browse/feed/`
                }
            };

            const callGemini = async (userPrompt, systemPrompt, retryCount = 0) => {
                if (!apiKey) throw new Error("API í‚¤ê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ì„¤ì • ë²„íŠ¼ì„ ëˆŒëŸ¬ í‚¤ë¥¼ ì…ë ¥í•˜ì„¸ìš”.");

                try {
                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            contents: [{ parts: [{ text: userPrompt }] }],
                            systemInstruction: { parts: [{ text: systemPrompt }] }
                        })
                    });

                    if (!response.ok) {
                        const errData = await response.json();
                        throw new Error(errData.error?.message || `API ì˜¤ë¥˜: ${response.status}`);
                    }
                    
                    const result = await response.json();
                    return result.candidates?.[0]?.content?.parts?.[0]?.text;
                } catch (err) {
                    if (retryCount < 3 && (err.message.includes('429') || err.message.includes('500'))) {
                        await new Promise(r => setTimeout(r, 1500 * Math.pow(2, retryCount)));
                        return callGemini(userPrompt, systemPrompt, retryCount + 1);
                    }
                    throw err;
                }
            };

            const handleCopy = (text) => {
                const textArea = document.createElement("textarea");
                textArea.value = text;
                textArea.style.position = "fixed";
                textArea.style.left = "-9999px";
                textArea.style.top = "0";
                document.body.appendChild(textArea);
                textArea.focus();
                textArea.select();
                try {
                    const successful = document.execCommand('copy');
                    if (successful) alert("ë‚´ìš©ì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!");
                    else throw new Error('Copy failed');
                } catch (err) {
                    console.error('Copy Error:', err);
                }
                document.body.removeChild(textArea);
            };

            const generateBlogPost = async () => {
                if (!apiKey) {
                    setIsModalOpen(true);
                    return;
                }
                if (selectedIndices.size === 0) return;
                
                setIsBlogGenerating(true);
                const selectedArticles = Array.from(selectedIndices).map(idx => results[idx]);
                const context = selectedArticles.map((a, i) => `ë‰´ìŠ¤ ${i+1}: ${a.title}\nì¶œì²˜: ${a.source}\në§í¬: ${a.link}\në‚´ìš©: ${a.summary}`).join('\n\n');
                
                const systemPrompt = `ë‹¹ì‹ ì€ ì „ë¬¸ì ì¸ ì§€ì‹ì„ ì „ë‹¬í•˜ëŠ” ë‰´ìŠ¤ ì—ë””í„°ì´ì íŒŒì›Œ ë¸”ë¡œê±°ì…ë‹ˆë‹¤. 
                ì œê³µëœ ë‰´ìŠ¤ ê¸°ì‚¬ë“¤ì„ ì‹¬ì¸µì ìœ¼ë¡œ ë¶„ì„í•˜ê³  ì¢…í•©í•˜ì—¬ í•˜ë‚˜ì˜ ì™„ì„±ëœ ì¥ë¬¸ì˜ ë¸”ë¡œê·¸ í¬ìŠ¤íŒ…ì„ ì‘ì„±í•˜ì‹­ì‹œì˜¤.
                
                ì‘ì„± ê·œì¹™:
                1. ë§íˆ¬: ë°˜ë“œì‹œ ì‹ ë¢°ê° ìˆê³  ê°ê´€ì ì¸ 'í‰ì„œë¬¸(~ì´ë‹¤, ~í•œë‹¤)' í˜•ì‹ì„ ì‚¬ìš©í•˜ì‹­ì‹œì˜¤.
                2. ë¶„ëŸ‰: ê³µë°± í¬í•¨ ìµœì†Œ 2,000ì ì´ìƒì˜ ìƒì„¸í•œ ë‚´ìš©ìœ¼ë¡œ êµ¬ì„±í•˜ì‹­ì‹œì˜¤. ê° ì„¹ì…˜ë§ˆë‹¤ ì¶©ë¶„í•œ ì„¤ëª…ê³¼ ë¶„ì„ì„ ë§ë¶™ì—¬ ê¹Šì´ ìˆëŠ” ê¸€ì„ ë§Œë“œì‹­ì‹œì˜¤.
                3. êµ¬ì„±: 
                   - ì´ëª©ì„ ë„ëŠ” ì„¸ë ¨ëœ ì œëª© (ì£¼ì œ ê´€ë ¨ ì´ëª¨ì§€ í¬í•¨)
                   - ì„œë¡ : ë°°ê²½ ì§€ì‹ê³¼ í˜„ì¬ ìƒí™© ì„¤ëª…
                   - ë³¸ë¬¸: ë‰´ìŠ¤ë“¤ì˜ í•µì‹¬ ë‚´ìš©ì„ ì†Œì£¼ì œë¡œ ë¶„ë¥˜í•˜ê³  ë¶„ì„ (ìœ ê¸°ì  ì—°ê²°)
                   - ğŸ§  í•œëˆˆì— ë³´ëŠ” íŠ¸ë Œë“œ ë³€í™”: ë§ˆí¬ë‹¤ìš´ í‘œ(Table) í˜•ì‹ì˜ ë¹„êµ ë¶„ì„ í¬í•¨
                   - ê²°ë¡ : ì¢…í•©ì ì¸ ë¶„ì„ ë° ì „ë§
                   - ğŸ“Œ ì°¸ê³  ìë£Œ ë° ì¶œì²˜: ë§ˆì§€ë§‰ì— ê¸°ì‚¬ ì œëª©ê³¼ URL ë§í¬ë¥¼ ë¦¬ìŠ¤íŠ¸ í˜•íƒœë¡œ ëª…ì‹œ
                4. í˜•ì‹: SEOì— ìµœì í™”ëœ ë§ˆí¬ë‹¤ìš´ í˜•ì‹ì„ ì‚¬ìš©í•˜ì‹­ì‹œì˜¤.`;

                try {
                    const post = await callGemini(`ë‹¤ìŒ ë‰´ìŠ¤ë“¤ì„ ë°”íƒ•ìœ¼ë¡œ ì „ë¬¸ì ì¸ í‰ì„œë¬¸ ë¸”ë¡œê·¸ í¬ìŠ¤íŒ…ì„ 2000ì ì´ìƒ ìƒì„¸í•˜ê²Œ ì¨ì¤˜:\n\n${context}`, systemPrompt);
                    setBlogPost(post);
                    setTimeout(() => blogRef.current?.scrollIntoView({ behavior: 'smooth' }), 200);
                } catch (err) {
                    console.error(err);
                    alert(err.message || "í¬ìŠ¤íŒ… ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
                } finally {
                    setIsBlogGenerating(false);
                }
            };

            const toggleSelect = (index) => {
                const newSelected = new Set(selectedIndices);
                if (newSelected.has(index)) newSelected.delete(index);
                else newSelected.add(index);
                setSelectedIndices(newSelected);
            };

            const handleLinkClick = (e, url) => {
                e.stopPropagation();
                window.open(url, '_blank', 'noopener,noreferrer');
            };

            const selectAll = () => setSelectedIndices(new Set(results.keys()));
            const deselectAll = () => setSelectedIndices(new Set());
            const scrollToResults = () => resultsRef.current?.scrollIntoView({ behavior: 'smooth' });

            const fetchNews = async () => {
                if (selectedSource === 'google' && !topic.trim()) {
                    setError('ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.');
                    return;
                }

                setLoading(true);
                setError(null);
                setResults([]);
                setSelectedIndices(new Set());
                setBlogPost('');

                const targetUrl = sources[selectedSource].getURL(topic);
                
                // --- ë” ë§ì€ í”„ë¡ì‹œ ê²½ë¡œì™€ íƒ€ì„ì•„ì›ƒ ì ìš© (ì•ˆì •ì„± ê·¹ëŒ€í™”) ---
                const proxies = [
                    { name: 'AllOrigins', url: (t) => `https://api.allorigins.win/get?url=${encodeURIComponent(t)}`, isJson: true },
                    { name: 'CorsProxyIO', url: (t) => `https://corsproxy.io/?url=${encodeURIComponent(t)}`, isJson: false },
                    { name: 'Codetabs', url: (t) => `https://api.codetabs.com/v1/proxy?quest=${encodeURIComponent(t)}`, isJson: false },
                    { name: 'Bridge', url: (t) => `https://cors-anywhere.azm.workers.dev/${t}`, isJson: false }
                ];

                let success = false;
                let rawContent = "";

                for (const proxy of proxies) {
                    try {
                        const controller = new AbortController();
                        const id = setTimeout(() => controller.abort(), 8000); // 8ì´ˆ íƒ€ì„ì•„ì›ƒ

                        const response = await fetch(proxy.url(targetUrl), { signal: controller.signal });
                        clearTimeout(id);

                        if (!response.ok) continue;
                        
                        if (proxy.isJson) {
                            const data = await response.json();
                            rawContent = data.contents;
                        } else {
                            rawContent = await response.text();
                        }

                        if (rawContent && (rawContent.includes('<item>') || rawContent.includes('<entry>'))) {
                            success = true;
                            break; 
                        }
                    } catch (e) {
                        console.warn(`Proxy ${proxy.name} failed or timed out. trying next...`);
                    }
                }

                if (!success) {
                    setError('ë‰´ìŠ¤ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. í”„ë¡ì‹œ ì„œë²„ë“¤ì´ ì‘ë‹µí•˜ì§€ ì•Šê±°ë‚˜ ë‰´ìŠ¤ ì†ŒìŠ¤ì—ì„œ ì°¨ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.');
                    setLoading(false);
                    return;
                }

                try {
                    const parser = new DOMParser();
                    const xmlDoc = parser.parseFromString(rawContent, "text/xml");
                    
                    if (xmlDoc.getElementsByTagName("parsererror").length > 0) {
                        throw new Error("XML íŒŒì‹± ì˜¤ë¥˜");
                    }

                    const items = Array.from(xmlDoc.querySelectorAll("item"));

                    if (items.length === 0) {
                        setError('ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤. ê²€ìƒ‰ì–´ì˜ ì² ìë¥¼ í™•ì¸í•˜ê±°ë‚˜ ë‹¤ë¥¸ í‚¤ì›Œë“œë¡œ ê²€ìƒ‰í•´ ë³´ì„¸ìš”.');
                        setLoading(false);
                        return;
                    }

                    let newsItems = items.map(item => ({
                        title: item.querySelector("title")?.textContent.split(" - ")[0] || "",
                        source: item.querySelector("title")?.textContent.split(" - ")[1] || sources[selectedSource].name,
                        link: item.querySelector("link")?.textContent || "",
                        pubDate: item.querySelector("pubDate")?.textContent 
                            ? new Date(item.querySelector("pubDate")?.textContent).toLocaleDateString('ko-KR')
                            : 'ë‚ ì§œ ë¯¸ìƒ',
                        summary: item.querySelector("description")?.textContent.replace(/<[^>]*>?/gm, '') || ""
                    }));

                    // ë¡œì»¬ í•„í„°ë§ (êµ¬ê¸€ ë‰´ìŠ¤ê°€ ì•„ë‹ ë•Œ)
                    if (selectedSource !== 'google' && topic.trim()) {
                        const searchLower = topic.toLowerCase();
                        newsItems = newsItems.filter(item => 
                            item.title.toLowerCase().includes(searchLower) || 
                            item.summary.toLowerCase().includes(searchLower)
                        );
                        
                        if (newsItems.length === 0) {
                            setError(`'${topic}' ì£¼ì œì— ëŒ€í•œ ê¸°ì‚¬ê°€ í˜„ì¬ í”¼ë“œì— ì—†ìŠµë‹ˆë‹¤. ì² ìë¥¼ í™•ì¸í•˜ê±°ë‚˜(ì˜ˆ: olympic) ë‹¤ë¥¸ í‚¤ì›Œë“œë¥¼ ì‹œë„í•´ ë³´ì„¸ìš”.`);
                            setLoading(false);
                            return;
                        }
                    }

                    setResults(newsItems.slice(0, 30));
                } catch (err) { 
                    console.error(err);
                    setError('ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ ë³´ì„¸ìš”.'); 
                } finally { 
                    setLoading(false); 
                }
            };

            return (
                <div className="min-h-screen bg-slate-50 font-sans text-slate-900 pb-20 scroll-smooth">
                    {/* Setup Modal */}
                    {isModalOpen && (
                        <div className="fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm">
                            <div className="bg-white w-full max-w-md rounded-3xl shadow-2xl overflow-hidden">
                                <div className="bg-indigo-600 p-6 flex items-center justify-between text-white">
                                    <div className="flex items-center gap-3">
                                        <Icon name="settings" className="w-6 h-6 animate-spin-slow" />
                                        <h2 className="text-xl font-bold">API ì„¤ì • (Setup)</h2>
                                    </div>
                                    <button onClick={() => setIsModalOpen(false)} className="p-2 hover:bg-white/20 rounded-full">
                                        <Icon name="x" className="w-6 h-6" />
                                    </button>
                                </div>
                                <div className="p-8 space-y-6">
                                    <div className="space-y-2">
                                        <label className="text-sm font-bold text-slate-700 flex items-center gap-2">
                                            <Icon name="key" className="w-4 h-4 text-indigo-600" />
                                            Gemini API Key
                                        </label>
                                        <div className="relative">
                                            <input
                                                type={showKey ? "text" : "password"}
                                                value={apiKey}
                                                onChange={(e) => setApiKey(e.target.value)}
                                                placeholder="AI Studio API Keyë¥¼ ì…ë ¥í•˜ì„¸ìš”..."
                                                className="w-full pl-4 pr-12 py-4 bg-slate-50 border border-slate-200 rounded-2xl outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 transition-all font-mono text-sm"
                                            />
                                            <button onClick={() => setShowKey(!showKey)} className="absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 hover:text-indigo-600">
                                                <Icon name={showKey ? "eye-off" : "eye"} className="w-5 h-5" />
                                            </button>
                                        </div>
                                        <p className="text-[11px] text-slate-400 mt-2">
                                            í‚¤ëŠ” <a href="https://aistudio.google.com/app/apikey" target="_blank" rel="noopener noreferrer" className="text-indigo-600 underline font-semibold">Google AI Studio</a>ì—ì„œ ë°œê¸‰ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                                        </p>
                                    </div>
                                    <button onClick={() => setIsModalOpen(false)} className="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 rounded-2xl shadow-lg transition-all active:scale-95">
                                        ì„¤ì • ì™„ë£Œ
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    <div className="max-w-5xl mx-auto px-4 py-8 md:py-12">
                        {/* Top Navbar */}
                        <div className="flex justify-end mb-8">
                            <button 
                                onClick={() => setIsModalOpen(true)}
                                className="flex items-center gap-2 px-5 py-2.5 bg-white border border-slate-200 rounded-2xl font-bold text-slate-600 hover:text-indigo-600 hover:border-indigo-200 transition-all group"
                            >
                                <Icon name="settings" className={`w-5 h-5 ${apiKey ? 'text-green-500' : 'text-slate-400'}`} />
                                <span>ì…‹ì—… (Setup)</span>
                                {!apiKey && <div className="w-2 h-2 bg-rose-500 rounded-full animate-ping ml-1" />}
                            </button>
                        </div>

                        {/* Main Header */}
                        <header className="text-center mb-10">
                            <div className={`inline-flex p-4 ${sources[selectedSource].color} rounded-3xl shadow-xl mb-6 transition-colors duration-500`}>
                                <Icon name="newspaper" className="w-10 h-10 text-white" />
                            </div>
                            <h1 className="text-3xl md:text-4xl font-black text-slate-900 tracking-tight mb-2">AI ë‰´ìŠ¤ & ë¸”ë¡œê·¸ ì—ë””í„°</h1>
                            <p className="text-slate-500 font-medium">30ê°œì˜ ìµœì‹  ë‰´ìŠ¤ë¥¼ ìˆ˜ì§‘í•˜ê³  AIë¡œ ë¸”ë¡œê·¸ í¬ìŠ¤íŒ…ì„ ìƒì„±í•©ë‹ˆë‹¤</p>
                        </header>

                        {/* Source Switcher */}
                        <div className="flex flex-wrap justify-center gap-2 mb-8">
                            {Object.entries(sources).map(([key, info]) => (
                                <button
                                    key={key}
                                    onClick={() => { setSelectedSource(key); setResults([]); setError(null); }}
                                    className={`px-6 py-2.5 rounded-2xl font-bold text-sm transition-all shadow-sm ${
                                        selectedSource === key ? `${info.color} text-white shadow-md scale-105` : 'bg-white text-slate-400 border border-slate-200 hover:border-slate-300'
                                    }`}
                                >
                                    {info.name}
                                </button>
                            ))}
                        </div>

                        {/* Search Bar */}
                        <div className="bg-white rounded-[2rem] shadow-sm border border-slate-200 p-2 mb-10 flex flex-col md:flex-row gap-2 transition-all focus-within:shadow-md">
                            <div className="relative flex-grow">
                                <Icon name="search" className="absolute left-5 top-1/2 -translate-y-1/2 text-slate-400 w-5 h-5" />
                                <input
                                    type="text"
                                    className="w-full pl-12 pr-4 py-4 border-none focus:ring-0 text-lg outline-none"
                                    placeholder="ê²€ìƒ‰ì–´ ì…ë ¥ (ì˜ˆ: olympic)..."
                                    value={topic}
                                    onChange={(e) => setTopic(e.target.value)}
                                    onKeyDown={(e) => e.key === 'Enter' && fetchNews()}
                                />
                            </div>
                            <button
                                onClick={fetchNews}
                                disabled={loading}
                                className={`${sources[selectedSource].color} text-white font-bold px-10 py-4 rounded-2xl flex items-center justify-center gap-2 transition-all active:scale-95`}
                            >
                                {loading ? <Icon name="loader-2" className="w-5 h-5 animate-spin" /> : "ìˆ˜ì§‘ ì‹œì‘"}
                            </button>
                        </div>

                        {/* Results Section */}
                        {results.length > 0 && (
                            <div ref={resultsRef} className="animate-in fade-in slide-in-from-bottom-4 duration-500">
                                <div className="sticky top-4 z-30 bg-white/95 backdrop-blur-md border border-slate-200 rounded-2xl p-4 mb-6 shadow-xl flex items-center justify-between gap-4">
                                    <div className="flex items-center gap-3 md:gap-4 shrink-0">
                                        <button onClick={selectedIndices.size === results.length ? deselectAll : selectAll} className="flex items-center gap-2 text-xs md:text-sm font-bold text-slate-600 hover:text-indigo-600">
                                            <Icon name={selectedIndices.size === results.length ? "check-square" : "square"} className={`w-5 h-5 ${selectedIndices.size === results.length ? 'text-indigo-600' : ''}`} />
                                            <span className="hidden sm:inline">ì „ì²´ ì„ íƒ</span>
                                        </button>
                                        <button onClick={deselectAll} className="flex items-center gap-2 text-xs md:text-sm font-bold text-slate-400 hover:text-rose-500" disabled={selectedIndices.size === 0}>
                                            <Icon name="x-square" className="w-5 h-5" />
                                            <span className="hidden sm:inline">ì„ íƒ í•´ì œ</span>
                                        </button>
                                        <div className="h-4 w-px bg-slate-200" />
                                        <span className="text-xs font-bold text-slate-500"><span className="text-indigo-600 font-black">{selectedIndices.size}</span>ê±´ ì„ íƒ</span>
                                    </div>
                                    <button
                                        onClick={generateBlogPost}
                                        disabled={selectedIndices.size === 0 || isBlogGenerating}
                                        className="bg-indigo-600 hover:bg-indigo-700 disabled:bg-slate-300 text-white px-5 md:px-8 py-3 rounded-xl font-bold text-xs md:text-sm flex items-center gap-2 transition-all shadow-lg shrink-0"
                                    >
                                        {isBlogGenerating ? <Icon name="loader-2" className="w-4 h-4 animate-spin" /> : <Icon name="pen-tool" className="w-4 h-4" />}
                                        AI ë¶„ì„ í¬ìŠ¤íŒ…
                                    </button>
                                </div>

                                <div className="bg-white rounded-[2rem] border border-slate-200 overflow-hidden shadow-sm mb-12">
                                    {results.map((item, idx) => (
                                        <div 
                                            key={idx}
                                            onClick={() => toggleSelect(idx)}
                                            className={`flex items-start gap-4 p-5 border-b border-slate-50 hover:bg-slate-50 cursor-pointer transition-colors ${selectedIndices.has(idx) ? 'bg-indigo-50/50' : ''}`}
                                        >
                                            <div className="pt-1 shrink-0">
                                                <Icon name={selectedIndices.has(idx) ? "check-square" : "square"} className={`w-5 h-5 ${selectedIndices.has(idx) ? 'text-indigo-600' : 'text-slate-300'}`} />
                                            </div>
                                            <div className="flex-grow min-w-0">
                                                <div className="flex items-center gap-2 mb-2">
                                                    <span className={`text-[10px] font-black uppercase px-2 py-0.5 rounded ${sources[selectedSource].color} text-white`}>{item.source}</span>
                                                    <span className="text-[10px] text-slate-400 font-bold">{item.pubDate}</span>
                                                </div>
                                                <div onClick={(e) => handleLinkClick(e, item.link)} className="block font-bold text-slate-900 hover:text-indigo-600 leading-snug mb-2 text-base md:text-lg">
                                                    {item.title}
                                                </div>
                                                <p className="text-xs md:text-sm text-slate-500 line-clamp-2 md:line-clamp-1 opacity-80">{item.summary}</p>
                                            </div>
                                            <div onClick={(e) => handleLinkClick(e, item.link)} className="shrink-0 p-2 text-slate-300 hover:text-indigo-600">
                                                <Icon name="external-link" className="w-5 h-5" />
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {/* AI Post Section */}
                        {blogPost && (
                            <div ref={blogRef} className="animate-in zoom-in-95 duration-500 mb-10">
                                <div className="bg-white rounded-[2.5rem] border-2 border-indigo-100 shadow-2xl overflow-hidden">
                                    <div className="bg-indigo-600 p-6 text-white flex items-center justify-between">
                                        <div className="flex items-center gap-3">
                                            <Icon name="sparkles" className="w-6 h-6 text-yellow-300" />
                                            <h2 className="font-black text-xl">AI ë‰´ìŠ¤ ë¶„ì„ í¬ìŠ¤íŒ…</h2>
                                        </div>
                                        <button onClick={() => handleCopy(blogPost)} className="bg-white/20 hover:bg-white/30 px-5 py-2 rounded-xl text-sm font-bold flex items-center gap-2 transition-all">
                                            <Icon name="copy" className="w-4 h-4" /> ë³¸ë¬¸ ë³µì‚¬
                                        </button>
                                    </div>
                                    <div className="p-8 md:p-12 prose prose-slate max-w-none prose-headings:text-indigo-900">
                                        <div className="whitespace-pre-wrap font-serif text-slate-800 leading-relaxed text-lg">
                                            {blogPost}
                                        </div>
                                    </div>
                                    <div className="bg-slate-50 p-6 flex justify-center border-t border-slate-100">
                                        <button onClick={scrollToResults} className="flex items-center gap-2 text-indigo-600 font-bold hover:text-indigo-800 hover:underline">
                                            <Icon name="arrow-up-circle" className="w-5 h-5" /> ë¦¬ìŠ¤íŠ¸ë¡œ ëŒì•„ê°€ê¸°
                                        </button>
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* Empty States */}
                        {!loading && results.length === 0 && !error && (
                            <div className="bg-white rounded-[3rem] p-24 text-center border border-dashed border-slate-300">
                                <Icon name="rss" className="w-16 h-16 text-slate-100 mx-auto mb-6" />
                                <h3 className="text-xl font-bold text-slate-400">ë¶„ì„í•  ë‰´ìŠ¤ë¥¼ ê²€ìƒ‰í•´ ë³´ì„¸ìš”</h3>
                                <p className="text-slate-300 mt-2">30ê°œì˜ ìµœì‹  ê¸°ì‚¬ë¥¼ ìˆ˜ì§‘í•˜ê³  AI í¬ìŠ¤íŒ…ì„ ìƒì„±í•©ë‹ˆë‹¤.</p>
                            </div>
                        )}

                        {error && (
                            <div className="bg-red-50 p-8 rounded-[2rem] border border-red-100 text-red-700 flex flex-col items-center text-center gap-4 animate-in slide-in-from-top-2">
                                <Icon name="alert-circle" className="w-12 h-12 mb-2" />
                                <div>
                                    <p className="font-bold text-lg mb-1">ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤</p>
                                    <p className="opacity-90 mb-6">{error}</p>
                                    <button 
                                        onClick={fetchNews}
                                        className="inline-flex items-center gap-2 bg-red-600 hover:bg-red-700 text-white px-6 py-2 rounded-xl font-bold transition-all shadow-lg active:scale-95"
                                    >
                                        <Icon name="refresh-ccw" className="w-4 h-4" />
                                        ë‹¤ì‹œ ì‹œë„í•˜ê¸°
                                    </button>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
