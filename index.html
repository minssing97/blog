<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ë¸Œë¦¬ì¦ˆë²ˆ íë§ ì—¬í–‰</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Leaflet JS (Map) -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brisbane: {
                            sand: '#f5f5dc',
                            teal: '#008080',
                            coral: '#ff7f50',
                            sun: '#ffd700',
                            light: '#fdfbf7',
                            dark: '#2d3748'
                        }
                    },
                    fontFamily: {
                        sans: ['Noto Sans KR', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap');
        
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #fdfbf7;
            color: #2d3748;
            -webkit-tap-highlight-color: transparent;
        }

        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin: 0 auto;
            height: 280px;
        }
        
        @media (min-width: 768px) {
            .chart-container { height: 350px; }
        }

        #map {
            height: 350px;
            width: 100%;
            border-radius: 1.5rem;
            z-index: 1;
        }

        @media (min-width: 768px) {
            #map { height: 500px; }
        }

        .tab-active {
            background-color: #ff7f50;
            color: white;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
        }
        
        .tab-inactive {
            background-color: white;
            color: #94a3b8;
            border: 1px solid #f1f5f9;
        }
        
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        .weather-gradient {
            background: linear-gradient(135deg, #6dd5ed, #2193b0);
        }

        .loading-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: .5; }
        }

        .touch-target {
            min-height: 44px;
            min-width: 44px;
        }

        .hotel-popup .leaflet-popup-content-wrapper {
            background: #008080;
            color: white;
            border-radius: 12px;
        }
        .hotel-popup .leaflet-popup-tip {
            background: #008080;
        }
    </style>
    <!-- Chosen Palette: Warm Neutrals with Teal, Coral, and Sky Blue Accents -->
    <!-- Application Structure Plan: 
        1. Hero Section: Displaying the main title "ë¸Œë¦¬ì¦ˆë²ˆ íë§ ì—¬í–‰" and sub-info.
        2. Live Dashboard: Real-time Weather and Currency tracking.
        3. Map Integration: Visualizing Atrio Apartments and key landmarks.
        4. Itinerary: Detailed daily tasks (Feb 15-21) using tabbed navigation.
        5. Jogging & Logistics: Contextualized data for running and packing.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>
<body class="flex flex-col min-h-screen">

    <!-- Navigation -->
    <nav class="bg-white/80 backdrop-blur-md shadow-sm sticky top-0 z-50">
        <div class="max-w-6xl mx-auto px-4">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center space-x-2">
                    <i class="fa-solid fa-koala text-2xl text-brisbane-teal"></i>
                    <span class="font-bold text-lg tracking-tight text-gray-800">ë¸Œë¦¬ì¦ˆë²ˆ íë§ ì—¬í–‰</span>
                </div>
                <div class="hidden md:flex space-x-6 text-sm font-medium">
                    <button onclick="scrollToSection('dashboard')" class="text-gray-600 hover:text-brisbane-teal transition">ëŒ€ì‹œë³´ë“œ</button>
                    <button onclick="scrollToSection('map-section')" class="text-gray-600 hover:text-brisbane-teal transition">ì§€ë„</button>
                    <button onclick="scrollToSection('itinerary')" class="text-gray-600 hover:text-brisbane-teal transition">ì¼ì •</button>
                    <button onclick="scrollToSection('jogging')" class="text-gray-600 hover:text-brisbane-teal transition">ì¡°ê¹…</button>
                </div>
                <div class="md:hidden flex space-x-2 text-gray-500">
                    <button onclick="scrollToSection('dashboard')" class="touch-target"><i class="fa-solid fa-chart-line"></i></button>
                    <button onclick="scrollToSection('map-section')" class="touch-target"><i class="fa-solid fa-map-location-dot"></i></button>
                    <button onclick="scrollToSection('itinerary')" class="touch-target"><i class="fa-solid fa-calendar-days"></i></button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <header class="bg-gradient-to-br from-brisbane-teal to-teal-800 text-white py-10 md:py-16">
        <div class="max-w-6xl mx-auto px-6 text-center">
            <div class="inline-block bg-white/20 backdrop-blur-md px-3 py-1 rounded-full text-[10px] md:text-xs font-bold mb-4 uppercase tracking-[0.2em]">
                Family Healing Trip
            </div>
            <h1 class="text-3xl md:text-5xl font-extrabold mb-4 tracking-tight">ë¸Œë¦¬ì¦ˆë²ˆ íë§ ì—¬í–‰</h1>
            <p class="text-sm md:text-lg opacity-90 max-w-xl mx-auto font-light">Fortitude Valleyë¥¼ ê±°ì ìœ¼ë¡œ ì¦ê¸°ëŠ” ìŠ¤ë§ˆíŠ¸ ì—¬ì • ê°€ì´ë“œ</p>
        </div>
    </header>

    <main class="flex-grow">
        <!-- Dashboard Section -->
        <section id="dashboard" class="py-6 max-w-6xl mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 md:gap-6">
                
                <!-- Weather Widget -->
                <div class="weather-gradient rounded-[2rem] p-6 text-white shadow-lg flex flex-col justify-between h-44 relative overflow-hidden md:col-span-1">
                    <div class="flex justify-between items-start z-10">
                        <div>
                            <h3 class="font-bold text-sm">ë¸Œë¦¬ì¦ˆë²ˆ ì‹¤ì‹œê°„ ë‚ ì”¨</h3>
                            <p class="text-[10px] opacity-80" id="weather-date">Loading...</p>
                        </div>
                        <div id="weather-icon-container">
                            <i class="fa-solid fa-cloud-sun text-2xl"></i>
                        </div>
                    </div>
                    <div class="z-10">
                        <span class="text-4xl font-bold" id="current-temp">--Â°</span>
                        <span class="text-xs ml-2 font-medium" id="weather-desc">ë¡œë”© ì¤‘</span>
                    </div>
                    <div class="text-[9px] opacity-80 border-t border-white/20 pt-2 flex justify-between z-10">
                        <span id="humidity-val"><i class="fa-solid fa-droplet mr-1"></i> --%</span>
                        <span id="wind-val"><i class="fa-solid fa-wind mr-1"></i> -- km/h</span>
                    </div>
                </div>

                <!-- Accommodation Info Card -->
                <div class="bg-white rounded-[2rem] p-6 shadow-sm border border-gray-100 h-44 flex flex-col justify-between md:col-span-1">
                    <h3 class="font-bold text-gray-700 text-xs flex items-center">
                        <i class="fa-solid fa-house-chimney mr-2 text-brisbane-teal"></i> ìˆ™ì†Œ ì •ë³´
                    </h3>
                    <div class="flex-grow flex flex-col justify-center space-y-1">
                        <p class="text-sm font-bold text-brisbane-dark">Atrio Apartments</p>
                        <p class="text-[10px] text-gray-500 leading-tight">29 Robertson St, Fortitude Valley</p>
                        <p class="text-[10px] text-gray-600"><i class="fa-solid fa-phone mr-1 text-[8px]"></i> +61 7 3177 3339</p>
                    </div>
                    <div class="flex justify-end">
                        <button onclick="focusHotel()" class="text-[10px] bg-brisbane-teal text-white px-3 py-1 rounded-full hover:bg-teal-700 transition">ì§€ë„ ë³´ê¸°</button>
                    </div>
                </div>

                <!-- Exchange Rate Card -->
                <div class="bg-white rounded-[2rem] p-6 shadow-sm border border-gray-100 flex flex-col h-44 justify-between md:col-span-1">
                    <div class="flex justify-between items-center">
                        <h3 class="font-bold text-gray-700 text-xs flex items-center">
                            <i class="fa-solid fa-won-sign mr-2 text-brisbane-coral"></i> í™˜ìœ¨ ê³„ì‚°ê¸°
                        </h3>
                        <span class="text-[8px] bg-green-100 text-green-700 px-2 py-0.5 rounded-full font-bold">LIVE</span>
                    </div>
                    <div>
                        <div class="flex items-baseline space-x-1 mb-1">
                            <span class="text-xl font-bold text-brisbane-dark" id="exchange-rate-val">---</span>
                            <span class="text-[9px] text-gray-400 uppercase">KRW / AUD</span>
                        </div>
                        <div class="flex items-center space-x-2 bg-gray-50 p-2 rounded-xl">
                            <input type="number" id="aud-calc" value="100" class="w-14 bg-transparent border-none p-0 text-xs font-bold focus:ring-0 text-center">
                            <span class="text-[9px] text-gray-400">AUD =</span>
                            <span class="text-xs font-bold text-brisbane-teal" id="krw-calc-res">---</span>
                            <span class="text-[9px] text-gray-400">ì›</span>
                        </div>
                    </div>
                    <p class="text-[8px] text-gray-400 italic" id="last-update-time">Loading rate...</p>
                </div>

                <!-- Ferry Guide Card -->
                <div class="bg-white rounded-[2rem] p-6 shadow-sm border border-gray-100 h-44 flex flex-col justify-between md:col-span-1">
                    <h3 class="font-bold text-gray-700 text-xs flex items-center">
                        <i class="fa-solid fa-ferry mr-2 text-blue-500"></i> í˜ë¦¬ ì´ìš© ê°€ì´ë“œ
                    </h3>
                    <div class="grid grid-cols-2 gap-2">
                        <div class="bg-red-50 p-2 rounded-xl border border-red-100/50 flex flex-col items-center">
                            <span class="text-base">â¤ï¸</span>
                            <span class="text-[8px] font-bold text-red-700">ì‹œí‹°í˜¸í¼</span>
                        </div>
                        <div class="bg-blue-50 p-2 rounded-xl border border-blue-100/50 flex flex-col items-center">
                            <span class="text-base">ğŸ’™</span>
                            <span class="text-[8px] font-bold text-blue-700">ì‹œí‹°ìº£</span>
                        </div>
                    </div>
                    <p class="text-[8px] text-gray-400 text-center">ìˆ™ì†Œ ì¸ê·¼ ì„ ì°©ì¥: Holman St</p>
                </div>
            </div>
        </section>

        <!-- Map Section -->
        <section id="map-section" class="py-6 bg-gray-50">
            <div class="max-w-6xl mx-auto px-4">
                <div class="mb-4 flex justify-between items-end">
                    <div>
                        <h2 class="text-xl font-bold text-brisbane-dark flex items-center">
                            <span class="w-1 h-5 bg-brisbane-coral mr-2 rounded-full"></span> ë¸Œë¦¬ì¦ˆë²ˆ ìŠ¤íŒŸ ì§€ë„
                        </h2>
                        <p class="text-[10px] text-gray-500 mt-1">ìˆ™ì†Œ(Atrio Apartments)ì™€ ì£¼ìš” ê´€ê´‘ì§€ ìœ„ì¹˜</p>
                    </div>
                </div>
                <div id="map" class="shadow-xl border-4 border-white"></div>
            </div>
        </section>

        <!-- Itinerary Section -->
        <section id="itinerary" class="py-10 max-w-6xl mx-auto px-4">
            <h2 class="text-xl font-bold text-brisbane-dark mb-6 flex items-center">
                <span class="w-1 h-5 bg-brisbane-teal mr-2 rounded-full"></span> ìƒì„¸ ì—¬í–‰ ì¼ì •
            </h2>
            
            <div class="flex overflow-x-auto space-x-2 mb-8 pb-4 no-scrollbar -mx-4 px-4" id="day-tabs"></div>

            <div id="day-content" class="bg-white rounded-[2.5rem] shadow-sm p-6 md:p-10 border border-gray-50 transition-all duration-300 min-h-[450px]"></div>
        </section>

        <!-- Jogging Section -->
        <section id="jogging" class="py-12 bg-brisbane-sand/20">
            <div class="max-w-6xl mx-auto px-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-10 items-center">
                    <div class="text-center md:text-left">
                        <h2 class="text-xl font-bold text-brisbane-dark mb-4">ë§¤ì¼ ì•„ì¹¨ ì¡°ê¹… ê°€ì´ë“œ</h2>
                        <p class="text-sm text-gray-500 mb-6">ìˆ™ì†Œì—ì„œ ì¶œë°œí•˜ì—¬ ì¦ê¸°ê¸° ì¢‹ì€ ì½”ìŠ¤ë¥¼ ë¶„ì„í–ˆìŠµë‹ˆë‹¤.</p>
                        <div class="flex flex-col space-y-3">
                            <button onclick="updateJoggingChart(0)" class="touch-target text-left p-4 bg-white rounded-2xl shadow-sm border-2 border-transparent hover:border-brisbane-teal transition-all group">
                                <h4 class="font-bold text-sm group-hover:text-brisbane-teal">ë³´íƒ€ë‹‰ ê°€ë“  (ì›”ìš”ì¼ ì¶”ì²œ)</h4>
                            </button>
                            <button onclick="updateJoggingChart(1)" class="touch-target text-left p-4 bg-white rounded-2xl shadow-sm border-2 border-transparent hover:border-brisbane-teal transition-all group">
                                <h4 class="font-bold text-sm group-hover:text-brisbane-teal">ì‚¬ìš°ìŠ¤ ë±…í¬ (í™”ìš”ì¼ ì¶”ì²œ)</h4>
                            </button>
                            <button onclick="updateJoggingChart(2)" class="touch-target text-left p-4 bg-white rounded-2xl shadow-sm border-2 border-transparent hover:border-brisbane-teal transition-all group">
                                <h4 class="font-bold text-sm group-hover:text-brisbane-teal">ë‰´ íŒœ ë¦¬ë²„ì›Œí¬ (ëª©ìš”ì¼ ì¶”ì²œ)</h4>
                            </button>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-3xl shadow-sm flex flex-col items-center">
                        <div class="chart-container">
                            <canvas id="joggingChart"></canvas>
                        </div>
                        <p class="text-[10px] text-gray-400 mt-4">ì½”ìŠ¤ë³„ qualitative ë¶„ì„ ë°ì´í„°</p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="bg-brisbane-dark text-white py-12 text-center">
        <p class="text-[10px] opacity-40 uppercase tracking-[0.2em] mb-4">Brisbane 2026 Family Healing Trip</p>
        <div class="flex justify-center space-x-8 text-xl opacity-60">
            <i class="fa-solid fa-person-running"></i>
            <i class="fa-solid fa-koala"></i>
            <i class="fa-solid fa-heart"></i>
        </div>
        <p class="text-[8px] opacity-30 mt-8">Weather: OpenWeatherMap | Exchange: ExchangeRate-API | Map: Leaflet</p>
    </footer>

    <script>
        // API Configuration
        const weatherApiKey = "0127bef44dbb798277979e0b6c680a3f"; 
        let currentRate = 890.5;
        let mapInstance;
        let hotelMarker;

        async function fetchWithRetry(url, options = {}, retries = 5, backoff = 1000) {
            try {
                const response = await fetch(url, options);
                if (!response.ok) throw new Error('API Error');
                return await response.json();
            } catch (err) {
                if (retries > 0) {
                    await new Promise(r => setTimeout(r, backoff));
                    return fetchWithRetry(url, options, retries - 1, backoff * 2);
                }
                throw err;
            }
        }

        const itineraryData = [
            { day: 1, date: "2/15", title: "ì‹œí‹° ì…ì„±", icon: "fa-plane-arrival", color: "text-blue-500", schedule: [{time: "08:05", activity: "ë¸Œë¦¬ì¦ˆë²ˆ ë„ì°©", icon: "fa-plane"}, {time: "08:05-11:00", activity: "ì…êµ­ìˆ˜ì† ë° ìˆ™ì†Œ(Atrio Apartments) ì´ë™", icon: "fa-car"}, {time: "11:00-12:00", activity: "ìˆ™ì†Œ ì²´í¬ì¸ ë° ì¬ì •ë¹„", icon: "fa-key"}, {time: "12:10", activity: "ì ì‹¬: Betty's Burgers", icon: "fa-hamburger"}, {time: "13:30", activity: "â¤ï¸ ë¬´ë£Œ í˜ë¦¬ íƒ€ê³  Riverside ì´ë™", icon: "fa-ferry", highlight: true}, {time: "16:30", activity: "ë³´íƒ€ë‹‰ ê°€ë“  ì¼ëª° í”¼í¬ë‹‰", icon: "fa-sun"}] },
            { day: 2, date: "2/16", title: "ë¬¸í™” Day", icon: "fa-palette", color: "text-green-600", schedule: [{time: "06:30", activity: "ğŸƒ ì¡°ê¹…: ë³´íƒ€ë‹‰ ê°€ë“ ", icon: "fa-person-running", highlight: true}, {time: "10:00", activity: "GOMA ë¯¸ìˆ ê´€ ê´€ëŒ", icon: "fa-image"}, {time: "15:15", activity: "ì‚¬ìš°ìŠ¤ ë±…í¬ ë¹„ì¹˜ íœ´ì‹", icon: "fa-umbrella-beach"}, {time: "18:30", activity: "ğŸ’™ ìœ ë£Œ í˜ë¦¬ ì´ë™ & ìš¸ì›ŒìŠ¤ ì¥ë³´ê¸°", icon: "fa-cart-shopping"}] },
            { day: 3, date: "2/17", title: "íŒ¨ë”©í„´ íë§", icon: "fa-house", color: "text-orange-500", schedule: [{time: "06:30", activity: "ğŸƒ ì¡°ê¹…: ì‚¬ìš°ìŠ¤ ë±…í¬", icon: "fa-person-running", highlight: true}, {time: "10:00", activity: "íŒ¨ë”©í„´ ì•¤í‹± ê±°ë¦¬ êµ¬ê²½", icon: "fa-gem"}, {time: "14:00", activity: "ì‚¬ìš°ìŠ¤ë±…í¬ ìˆ˜ì˜ & í”¼í¬ë‹‰", icon: "fa-water"}, {time: "17:30", activity: "ìº¥ê±°ë£¨ í¬ì¸íŠ¸ ì•¼ê²½ ì‚°ì±…", icon: "fa-moon"}] },
            { day: 4, date: "2/18", title: "ì„¬ ì—¬í–‰", icon: "fa-island-tropical", color: "text-teal-500", schedule: [{time: "08:00", activity: "ë…¸ìŠ¤ ìŠ¤íŠ¸ë˜ë“œë¸Œë¡ ì„¬ ì¶œë°œ", icon: "fa-ship"}, {time: "ì „ì¼", activity: "í¬ì¸íŠ¸ ë£©ì•„ì›ƒ íë§ ì‚°ì±…", icon: "fa-binoculars", highlight: true}] },
            { day: 5, date: "2/19", title: "ì œì„ìŠ¤ ìŠ¤íŠ¸ë¦¿", icon: "fa-users", color: "text-purple-500", schedule: [{time: "06:30", activity: "ğŸƒ ì¡°ê¹…: ë¦¬ë²„ì›Œí¬", icon: "fa-person-running", highlight: true}, {time: "13:00", activity: "ì œì„ìŠ¤ ìŠ¤íŠ¸ë¦¿ ì‡¼í•‘", icon: "fa-shopping-cart"}, {time: "15:00", activity: "â¤ï¸ Holman St ì„ ì°©ì¥ ë¬´ë£Œ í˜ë¦¬", icon: "fa-ferry"}, {time: "18:00", activity: "ë¦¬ë²„ì‚¬ì´ë“œ ê°€ì¡± ì €ë… ì‹ì‚¬", icon: "fa-utensils"}] },
            { day: 6, date: "2/20", title: "ê³¨ë“œì½”ìŠ¤íŠ¸", icon: "fa-sun", color: "text-yellow-500", schedule: [{time: "ì „ì¼", activity: "ê³¨ë“œì½”ìŠ¤íŠ¸ ì„œí¼ìŠ¤ íŒŒë¼ë‹¤ì´ìŠ¤", icon: "fa-water"}, {time: "19:00", activity: "ìˆ™ì†Œ ìŠ¤í…Œì´í¬ íŒŒí‹° ğŸ¥©", icon: "fa-fire", highlight: true}] },
            { day: 7, date: "2/21", title: "ë§ˆì¼“ & ì¶œêµ­", icon: "fa-plane-departure", color: "text-gray-500", schedule: [{time: "07:00", activity: "ì›¨ìŠ¤íŠ¸ì—”ë“œ í† ìš” ë§ˆì¼“ êµ¬ê²½", icon: "fa-basket-shopping", highlight: true}, {time: "09:30", activity: "ìš°ë²„ íƒ€ê³  ê³µí•­ ì´ë™", icon: "fa-car"}, {time: "11:20", activity: "ë¸Œë¦¬ì¦ˆë²ˆ ì¶œë°œ âœˆï¸", icon: "fa-plane"}] }
        ];

        function initMap() {
            mapInstance = L.map('map', { scrollWheelZoom: false, zoomControl: false }).setView([-27.465, 153.025], 14);
            L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png').addTo(mapInstance);
            
            const spots = [
                { name: "í€¸ ìŠ¤íŠ¸ë¦¬íŠ¸ ëª°", lat: -27.4701, lng: 153.0260 },
                { name: "ì‚¬ìš°ìŠ¤ ë±…í¬", lat: -27.4772, lng: 153.0210 },
                { name: "ë³´íƒ€ë‹‰ ê°€ë“ ", lat: -27.4744, lng: 153.0315 },
                { name: "ì œì„ìŠ¤ ìŠ¤íŠ¸ë¦¬íŠ¸", lat: -27.4583, lng: 153.0401 },
                { name: "GOMA ë¯¸ìˆ ê´€", lat: -27.4714, lng: 153.0175 },
                { name: "ìº¥ê±°ë£¨ í¬ì¸íŠ¸", lat: -27.4795, lng: 153.0355 }
            ];
            
            spots.forEach(m => L.marker([m.lat, m.lng]).addTo(mapInstance).bindPopup(m.name));

            hotelMarker = L.marker([-27.4579, 153.0376]).addTo(mapInstance)
                .bindPopup('<b>Atrio Apartments (ìˆ™ì†Œ)</b><br>29 Robertson St<br>T: +61 7 3177 3339', { className: 'hotel-popup' })
                .openPopup();
        }

        function focusHotel() {
            if (mapInstance && hotelMarker) {
                mapInstance.setView([-27.4579, 153.0376], 16);
                hotelMarker.openPopup();
                scrollToSection('map-section');
            }
        }

        async function fetchWeather() {
            const tempEl = document.getElementById('current-temp');
            const descEl = document.getElementById('weather-desc');
            const iconEl = document.getElementById('weather-icon-container');
            
            tempEl.classList.add('loading-pulse');
            
            try {
                const url = `https://api.openweathermap.org/data/2.5/weather?q=Brisbane,au&units=metric&appid=${weatherApiKey}&lang=kr`;
                const data = await fetchWithRetry(url);
                
                tempEl.innerText = `${Math.round(data.main.temp)}Â°`;
                descEl.innerText = data.weather[0].description;
                document.getElementById('humidity-val').innerHTML = `<i class="fa-solid fa-droplet"></i> ìŠµë„ ${data.main.humidity}%`;
                document.getElementById('wind-val').innerHTML = `<i class="fa-solid fa-wind"></i> í’ì† ${Math.round(data.wind.speed * 3.6)}km/h`;
                document.getElementById('weather-date').innerText = new Date().toLocaleDateString('ko-KR', { month: 'short', day: 'numeric', weekday: 'short' });
                
                const weatherMain = data.weather[0].main.toLowerCase();
                let iconClass = "fa-cloud-sun";
                if (weatherMain.includes('rain')) iconClass = "fa-cloud-showers-heavy";
                else if (weatherMain.includes('clear')) iconClass = "fa-sun";
                else if (weatherMain.includes('cloud')) iconClass = "fa-cloud";
                iconEl.innerHTML = `<i class="fa-solid ${iconClass} text-3xl"></i>`;
                
                tempEl.classList.remove('loading-pulse');
            } catch (err) { 
                descEl.innerText = "Weather Error";
                tempEl.classList.remove('loading-pulse');
            }
        }

        async function fetchExchangeRate() {
            try {
                const data = await fetchWithRetry(`https://open.er-api.com/v6/latest/AUD`);
                currentRate = data.rates.KRW;
                document.getElementById('exchange-rate-val').innerText = currentRate.toLocaleString(undefined, { maximumFractionDigits: 1 });
                document.getElementById('last-update-time').innerText = `ìµœê·¼ ì—…ë°ì´íŠ¸: ${new Date().toLocaleTimeString()}`;
                updateCalc();
            } catch (err) { document.getElementById('exchange-rate-val').innerText = "890.5"; }
        }

        function updateCalc() {
            const aud = document.getElementById('aud-calc').value;
            document.getElementById('krw-calc-res').innerText = (aud * currentRate).toLocaleString(undefined, { maximumFractionDigits: 0 });
        }

        let currentDayIdx = 0;
        function renderTabs() {
            const container = document.getElementById('day-tabs');
            container.innerHTML = itineraryData.map((d, i) => `
                <button onclick="switchDay(${i})" class="flex-shrink-0 px-5 py-2 rounded-xl text-xs font-bold transition-all shadow-sm ${i === currentDayIdx ? 'tab-active' : 'tab-inactive'}">
                    ${d.date}
                </button>
            `).join('');
        }

        function switchDay(idx) {
            currentDayIdx = idx;
            renderTabs();
            renderContent();
        }

        function renderContent() {
            const data = itineraryData[currentDayIdx];
            const container = document.getElementById('day-content');
            container.innerHTML = `
                <div class="flex items-center space-x-4 mb-8">
                    <div class="w-12 h-12 rounded-2xl bg-gray-50 flex items-center justify-center shadow-inner">
                        <i class="fa-solid ${data.icon} ${data.color} text-xl"></i>
                    </div>
                    <div>
                        <h3 class="text-xl font-bold text-gray-800 tracking-tight">${data.title}</h3>
                        <p class="text-[10px] text-gray-400">Brisbane â€¢ Feb ${data.date}</p>
                    </div>
                </div>
                <div class="space-y-4 border-l-2 border-gray-100 ml-6 pl-8">
                    ${data.schedule.map(item => `
                        <div class="relative py-2">
                            <div class="absolute -left-[41px] top-1/2 -translate-y-1/2 w-4 h-4 rounded-full border-4 border-white ${item.highlight ? 'bg-brisbane-coral' : 'bg-gray-200'}"></div>
                            <div class="flex flex-col bg-gray-50/50 p-4 rounded-2xl border border-transparent hover:bg-white hover:border-gray-100 transition-all">
                                <span class="text-brisbane-teal font-black text-[10px] mb-1">${item.time}</span>
                                <span class="text-sm text-gray-700 font-semibold">${item.activity}</span>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function initCharts() {
            const ctx = document.getElementById('joggingChart').getContext('2d');
            window.jogChart = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['ê²½ì¹˜', 'í‰íƒ„í•¨', 'ê·¸ëŠ˜', 'ì ‘ê·¼ì„±', 'ì¡°ìš©í•¨'],
                    datasets: [
                        { label: 'ë³´íƒ€ë‹‰ ê°€ë“ ', data: [4, 5, 5, 5, 4], borderColor: '#008080', backgroundColor: 'rgba(0, 128, 128, 0.1)', pointRadius: 0 },
                        { label: 'ì‚¬ìš°ìŠ¤ ë±…í¬', data: [5, 5, 3, 4, 3], borderColor: '#ff7f50', backgroundColor: 'rgba(255, 127, 80, 0.1)', hidden: true, pointRadius: 0 },
                        { label: 'ë‰´ íŒœ', data: [5, 4, 2, 3, 5], borderColor: '#2193b0', backgroundColor: 'rgba(33, 147, 176, 0.1)', hidden: true, pointRadius: 0 }
                    ]
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false, 
                    scales: { r: { suggestedMin: 0, suggestedMax: 5, grid: { color: '#f0f0f0' }, pointLabels: { font: { size: 10 } } } }, 
                    plugins: { legend: { display: false } } 
                }
            });
        }

        function updateJoggingChart(idx) {
            window.jogChart.data.datasets.forEach((d, i) => d.hidden = i !== idx);
            window.jogChart.update();
        }

        function scrollToSection(id) { document.getElementById(id).scrollIntoView({ behavior: 'smooth' }); }

        document.addEventListener('DOMContentLoaded', () => {
            initMap();
            fetchWeather();
            fetchExchangeRate();
            renderTabs();
            switchDay(0);
            initCharts();
            document.getElementById('aud-calc').addEventListener('input', updateCalc);
        });
    </script>
</body>
</html>
